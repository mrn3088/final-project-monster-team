<!DOCTYPE html>
<html>
<head>
  <!-- Include ZingGrid, ZingChart, and axios libraries -->
  <script src="https://cdn.zinggrid.com/zinggrid.min.js"></script>
  <script src="https://cdn.zingchart.com/zingchart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <title>Data Visualization</title>
</head>
<body>
  <!-- Define your ZingGrid for Browser usage -->
  <zing-grid
    id="browserGrid"
    caption="Browser Usage"
    data='[]'>
    <zg-column index="browserType" header="Browser Type"></zg-column>
    <zg-column index="count" header="Count"></zg-column>
  </zing-grid>

  <!-- Define your ZingGrid for language usage -->
  <zing-grid
    id="languageGrid"
    caption="Language Usage"
    data='[]'>
    <zg-column index="language" header="Language"></zg-column>
    <zg-column index="count" header="Count"></zg-column>
  </zing-grid>

  <!-- Define your ZingChart for load times -->
  <div id="load-time-chart"></div>

  <script>
    // Initialize arrays to store the counts of each browser type and language
    var browserData = [
      // Your existing browser data here
    ];
    var languageData = [
      // Similar to browserData, but for languages
    ];
    var loadTimeData = {
      "type": "line",
      "series": [
        {"values": []},  // pageStartLoad times
        {"values": []}   // totalLoadTime times
      ]
    };

    // Fetch data from your Express app
    axios.get('https://cse135.monster/api/static')
      .then(response => {
        // Your existing logic for browserData here
        // You can add similar logic for languageData if necessary

        // Update the ZingGrid with the new data
        document.getElementById('browserGrid').setData(browserData);
        document.getElementById('languageGrid').setData(languageData);
      })
      .catch(error => {
        console.error('Error fetching static data:', error);
      });

    axios.get('https://cse135.monster/api/performance/')
      .then(response => {
        let data = response.data;
        for(let i = 0; i < data.length; i++) {
          let value = data[i];
          loadTimeData.series[0].values.push(value['pageStartLoad']);
          loadTimeData.series[1].values.push(value['totalLoadTime']);
        }
        
        // Update the ZingChart with the new data
        zingchart.render({
          id: 'load-time-chart',
          data: loadTimeData,
          height: 400,
          width: 600
        });
      })
      .catch(error => {
        console.error('Error fetching performance data:', error);
      });
  </script>
</body>
</html>
