<!DOCTYPE html>
<html>
<head>
  <!-- Include ZingGrid and axios libraries -->
  <script src="https://cdn.zinggrid.com/zinggrid.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <title>Data Visualization</title>
</head>
<body>
  <!-- Define your ZingGrid -->
  <zing-grid
    id="myGrid"
    caption="Browser Usage"
    data='[]'>
    <zg-column index="browserType" header="Browser Type"></zg-column>
    <zg-column index="count" header="Count"></zg-column>
  </zing-grid>

  <script>
    // Initialize an array to store the counts of each browser type
    var data = [
      { browserType: 'Chrome', count: 0 },
      { browserType: 'Firefox', count: 0 },
      { browserType: 'Safari', count: 0 },
      { browserType: 'Internet Explorer', count: 0 },
      { browserType: 'Other', count: 0 }
    ];

    // Fetch data from your Express app
    axios.get('https://cse135.monster/api/static')  // 注意这里使用http，不是https
      .then(response => {
        var records = response.data;
        if (!Array.isArray(records)) {
          console.error('Response data is not an array:', records);
          return;
        }
        for (var i = 0; i < records.length; i++) {
          var userAgent = records[i].userAgent;
          if (userAgent.includes('Chrome')) {
            data[0].count++;
          } else if (userAgent.includes('Firefox')) {
            data[1].count++;
          } else if (userAgent.includes('Safari')) {
            data[2].count++;
          } else if (userAgent.includes('Internet Explorer')) {
            data[3].count++;
          } else {
            data[4].count++;
          }
        }

        // Update the ZingGrid with the new data
        document.getElementById('myGrid').setData(data);
      })
      .catch(error => {
        console.error('Error fetching data:', error);
      });
  </script>
</body>
</html>
